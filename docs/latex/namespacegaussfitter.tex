\hypertarget{namespacegaussfitter}{\section{gaussfitter Namespace Reference}
\label{namespacegaussfitter}\index{gaussfitter@{gaussfitter}}
}
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
def \hyperlink{namespacegaussfitter_abd1c2194b2b4e46cf45ddfad70b03ceb}{moments}
\item 
def \hyperlink{namespacegaussfitter_a5ecea45513967b2a9673f8d484b1659c}{twodgaussian}
\item 
def \hyperlink{namespacegaussfitter_a216f1dc4453e3f52cbb62651be3d53c4}{gaussfit}
\item 
def \hyperlink{namespacegaussfitter_a0105f3835732be908715a64b0d103175}{onedmoments}
\item 
def \hyperlink{namespacegaussfitter_ae1b5c20c3b0c0dd91a2546de6234f4f3}{onedgaussian}
\item 
def \hyperlink{namespacegaussfitter_a1f9aea874228a76d5cb959c0a6cb777f}{onedgaussfit}
\item 
def \hyperlink{namespacegaussfitter_a7ccbf085e35174083d4761487269b4cb}{n\-\_\-gaussian}
\item 
def \hyperlink{namespacegaussfitter_a016a73df3118713791355e1368b0a932}{multigaussfit}
\item 
\hypertarget{namespacegaussfitter_a90a54f5036afe56b9a3b0d0de0eb52fb}{def {\bfseries collapse\-\_\-gaussfit}}\label{namespacegaussfitter_a90a54f5036afe56b9a3b0d0de0eb52fb}

\end{DoxyCompactItemize}


\subsection{Detailed Description}
\begin{DoxyVerb}===========
gaussfitter
===========
.. codeauthor:: Adam Ginsburg <adam.g.ginsburg@gmail.com> 3/17/08

Latest version available at <http://code.google.com/p/agpy/source/browse/trunk/agpy/gaussfitter.py>\end{DoxyVerb}
 

\subsection{Function Documentation}
\hypertarget{namespacegaussfitter_a216f1dc4453e3f52cbb62651be3d53c4}{\index{gaussfitter@{gaussfitter}!gaussfit@{gaussfit}}
\index{gaussfit@{gaussfit}!gaussfitter@{gaussfitter}}
\subsubsection[{gaussfit}]{\setlength{\rightskip}{0pt plus 5cm}def gaussfitter.\-gaussfit (
\begin{DoxyParamCaption}
\item[{}]{data, }
\item[{}]{err = {\ttfamily None}, }
\item[{}]{params = {\ttfamily ()}, }
\item[{}]{autoderiv = {\ttfamily True}, }
\item[{}]{return\-\_\-all = {\ttfamily False}, }
\item[{}]{circle = {\ttfamily False}, }
\item[{}]{fixed = {\ttfamily numpy.repeat(False,7}, }
\item[{}]{limitedmin = {\ttfamily \mbox{[}False}, }
\item[{}]{False, }
\item[{}]{False, }
\item[{}]{False, }
\item[{}]{True, }
\item[{}]{True, }
\item[{}]{True, }
\item[{}]{limitedmax = {\ttfamily \mbox{[}False}, }
\item[{}]{False, }
\item[{}]{False, }
\item[{}]{False, }
\item[{}]{False, }
\item[{}]{False, }
\item[{}]{True, }
\item[{}]{usemoment = {\ttfamily numpy.array(\mbox{[}\mbox{]},dtype='bool'}, }
\item[{}]{minpars = {\ttfamily numpy.repeat(0,7}, }
\item[{}]{maxpars = {\ttfamily \mbox{[}0}, }
\item[{}]{rotate = {\ttfamily 1}, }
\item[{}]{vheight = {\ttfamily 1}, }
\item[{}]{quiet = {\ttfamily True}, }
\item[{}]{returnmp = {\ttfamily False}, }
\item[{}]{returnfitimage = {\ttfamily False}, }
\item[{}]{kwargs}
\end{DoxyParamCaption}
)}}\label{namespacegaussfitter_a216f1dc4453e3f52cbb62651be3d53c4}
\begin{DoxyVerb}Gaussian fitter with the ability to fit a variety of different forms of
2-dimensional gaussian.

Input Parameters:
    data - 2-dimensional data array
    err=None - error array with same size as data array
    params=[] - initial input parameters for Gaussian function.
        (height, amplitude, x, y, width_x, width_y, rota)
        if not input, these will be determined from the moments of the system, 
        assuming no rotation
    autoderiv=1 - use the autoderiv provided in the lmder.f function (the
        alternative is to us an analytic derivative with lmdif.f: this method
        is less robust)
    return_all=0 - Default is to return only the Gaussian parameters.  
               1 - fit params, fit error
    returnfitimage - returns (best fit params,best fit image)
    returnmp - returns the full mpfit struct
    circle=0 - default is an elliptical gaussian (different x, y widths),
        but can reduce the input by one parameter if it's a circular gaussian
    rotate=1 - default allows rotation of the gaussian ellipse.  Can remove
        last parameter by setting rotate=0.  numpy.expects angle in DEGREES
    vheight=1 - default allows a variable height-above-zero, i.e. an
        additive constant for the Gaussian function.  Can remove first
        parameter by setting this to 0
    usemoment - can choose which parameters to use a moment estimation for.
        Other parameters will be taken from params.  Needs to be a boolean
        array.

Output:
    Default output is a set of Gaussian parameters with the same shape as
        the input parameters

    Can also output the covariance matrix, 'infodict' that contains a lot
        more detail about the fit (see scipy.optimize.leastsq), and a message
        from leastsq telling what the exit status of the fitting routine was

    Warning: Does NOT necessarily output a rotation angle between 0 and 360 degrees.
\end{DoxyVerb}
 \hypertarget{namespacegaussfitter_abd1c2194b2b4e46cf45ddfad70b03ceb}{\index{gaussfitter@{gaussfitter}!moments@{moments}}
\index{moments@{moments}!gaussfitter@{gaussfitter}}
\subsubsection[{moments}]{\setlength{\rightskip}{0pt plus 5cm}def gaussfitter.\-moments (
\begin{DoxyParamCaption}
\item[{}]{data, }
\item[{}]{circle, }
\item[{}]{rotate, }
\item[{}]{vheight, }
\item[{}]{estimator = {\ttfamily median}, }
\item[{}]{kwargs}
\end{DoxyParamCaption}
)}}\label{namespacegaussfitter_abd1c2194b2b4e46cf45ddfad70b03ceb}
\begin{DoxyVerb}Returns (height, amplitude, x, y, width_x, width_y, rotation angle)
the gaussian parameters of a 2D distribution by calculating its
moments.  Depending on the input parameters, will only output 
a subset of the above.

If using masked arrays, pass estimator=numpy.ma.median
\end{DoxyVerb}
 \hypertarget{namespacegaussfitter_a016a73df3118713791355e1368b0a932}{\index{gaussfitter@{gaussfitter}!multigaussfit@{multigaussfit}}
\index{multigaussfit@{multigaussfit}!gaussfitter@{gaussfitter}}
\subsubsection[{multigaussfit}]{\setlength{\rightskip}{0pt plus 5cm}def gaussfitter.\-multigaussfit (
\begin{DoxyParamCaption}
\item[{}]{xax, }
\item[{}]{data, }
\item[{}]{ngauss = {\ttfamily 1}, }
\item[{}]{err = {\ttfamily None}, }
\item[{}]{params = {\ttfamily \mbox{[}1}, }
\item[{}]{fixed = {\ttfamily \mbox{[}False}, }
\item[{}]{False, }
\item[{}]{False, }
\item[{}]{limitedmin = {\ttfamily \mbox{[}False}, }
\item[{}]{False, }
\item[{}]{True, }
\item[{}]{limitedmax = {\ttfamily \mbox{[}False}, }
\item[{}]{False, }
\item[{}]{False, }
\item[{}]{minpars = {\ttfamily \mbox{[}0}, }
\item[{}]{maxpars = {\ttfamily \mbox{[}0}, }
\item[{}]{quiet = {\ttfamily True}, }
\item[{}]{shh = {\ttfamily True}, }
\item[{}]{veryverbose = {\ttfamily False}}
\end{DoxyParamCaption}
)}}\label{namespacegaussfitter_a016a73df3118713791355e1368b0a932}
\begin{DoxyVerb}An improvement on onedgaussfit.  Lets you fit multiple gaussians.

Inputs:
   xax - x axis
   data - y axis
   ngauss - How many gaussians to fit?  Default 1 (this could supersede onedgaussfit)
   err - error corresponding to data

 These parameters need to have length = 3*ngauss.  If ngauss > 1 and length = 3, they will
 be replicated ngauss times, otherwise they will be reset to defaults:
   params - Fit parameters: [amplitude, offset, width] * ngauss
          If len(params) % 3 == 0, ngauss will be set to len(params) / 3
   fixed - Is parameter fixed?
   limitedmin/minpars - set lower limits on each parameter (default: width>0)
   limitedmax/maxpars - set upper limits on each parameter

   quiet - should MPFIT output each iteration?
   shh - output final parameters?

Returns:
   Fit parameters
   Model
   Fit errors
   chi2
\end{DoxyVerb}
 \hypertarget{namespacegaussfitter_a7ccbf085e35174083d4761487269b4cb}{\index{gaussfitter@{gaussfitter}!n\-\_\-gaussian@{n\-\_\-gaussian}}
\index{n\-\_\-gaussian@{n\-\_\-gaussian}!gaussfitter@{gaussfitter}}
\subsubsection[{n\-\_\-gaussian}]{\setlength{\rightskip}{0pt plus 5cm}def gaussfitter.\-n\-\_\-gaussian (
\begin{DoxyParamCaption}
\item[{}]{pars = {\ttfamily None}, }
\item[{}]{a = {\ttfamily None}, }
\item[{}]{dx = {\ttfamily None}, }
\item[{}]{sigma = {\ttfamily None}}
\end{DoxyParamCaption}
)}}\label{namespacegaussfitter_a7ccbf085e35174083d4761487269b4cb}
\begin{DoxyVerb}Returns a function that sums over N gaussians, where N is the length of
a,dx,sigma *OR* N = len(pars) / 3

The background "height" is assumed to be zero (you must "baseline" your
spectrum before fitting)

pars  - a list with len(pars) = 3n, assuming a,dx,sigma repeated
dx    - offset (velocity center) values
sigma - line widths
a     - amplitudes
\end{DoxyVerb}
 \hypertarget{namespacegaussfitter_a1f9aea874228a76d5cb959c0a6cb777f}{\index{gaussfitter@{gaussfitter}!onedgaussfit@{onedgaussfit}}
\index{onedgaussfit@{onedgaussfit}!gaussfitter@{gaussfitter}}
\subsubsection[{onedgaussfit}]{\setlength{\rightskip}{0pt plus 5cm}def gaussfitter.\-onedgaussfit (
\begin{DoxyParamCaption}
\item[{}]{xax, }
\item[{}]{data, }
\item[{}]{err = {\ttfamily None}, }
\item[{}]{params = {\ttfamily \mbox{[}0}, }
\item[{}]{fixed = {\ttfamily \mbox{[}False}, }
\item[{}]{False, }
\item[{}]{False, }
\item[{}]{False, }
\item[{}]{limitedmin = {\ttfamily \mbox{[}False}, }
\item[{}]{False, }
\item[{}]{False, }
\item[{}]{True, }
\item[{}]{limitedmax = {\ttfamily \mbox{[}False}, }
\item[{}]{False, }
\item[{}]{False, }
\item[{}]{False, }
\item[{}]{minpars = {\ttfamily \mbox{[}0}, }
\item[{}]{maxpars = {\ttfamily \mbox{[}0}, }
\item[{}]{quiet = {\ttfamily True}, }
\item[{}]{shh = {\ttfamily True}, }
\item[{}]{veryverbose = {\ttfamily False}, }
\item[{}]{vheight = {\ttfamily True}, }
\item[{}]{negamp = {\ttfamily False}, }
\item[{}]{usemoments = {\ttfamily False}}
\end{DoxyParamCaption}
)}}\label{namespacegaussfitter_a1f9aea874228a76d5cb959c0a6cb777f}
\begin{DoxyVerb}Inputs:
   xax - x axis
   data - y axis
   err - error corresponding to data

   params - Fit parameters: Height of background, Amplitude, Shift, Width
   fixed - Is parameter fixed?
   limitedmin/minpars - set lower limits on each parameter (default: width>0)
   limitedmax/maxpars - set upper limits on each parameter
   quiet - should MPFIT output each iteration?
   shh - output final parameters?
   usemoments - replace default parameters with moments

Returns:
   Fit parameters
   Model
   Fit errors
   chi2
\end{DoxyVerb}
 \hypertarget{namespacegaussfitter_ae1b5c20c3b0c0dd91a2546de6234f4f3}{\index{gaussfitter@{gaussfitter}!onedgaussian@{onedgaussian}}
\index{onedgaussian@{onedgaussian}!gaussfitter@{gaussfitter}}
\subsubsection[{onedgaussian}]{\setlength{\rightskip}{0pt plus 5cm}def gaussfitter.\-onedgaussian (
\begin{DoxyParamCaption}
\item[{}]{x, }
\item[{}]{H, }
\item[{}]{A, }
\item[{}]{dx, }
\item[{}]{w}
\end{DoxyParamCaption}
)}}\label{namespacegaussfitter_ae1b5c20c3b0c0dd91a2546de6234f4f3}
\begin{DoxyVerb}Returns a 1-dimensional gaussian of form
H+A*numpy.exp(-(x-dx)**2/(2*w**2))
\end{DoxyVerb}
 \hypertarget{namespacegaussfitter_a0105f3835732be908715a64b0d103175}{\index{gaussfitter@{gaussfitter}!onedmoments@{onedmoments}}
\index{onedmoments@{onedmoments}!gaussfitter@{gaussfitter}}
\subsubsection[{onedmoments}]{\setlength{\rightskip}{0pt plus 5cm}def gaussfitter.\-onedmoments (
\begin{DoxyParamCaption}
\item[{}]{Xax, }
\item[{}]{data, }
\item[{}]{vheight = {\ttfamily True}, }
\item[{}]{estimator = {\ttfamily median}, }
\item[{}]{negamp = {\ttfamily None}, }
\item[{}]{veryverbose = {\ttfamily False}, }
\item[{}]{kwargs}
\end{DoxyParamCaption}
)}}\label{namespacegaussfitter_a0105f3835732be908715a64b0d103175}
\begin{DoxyVerb}Returns (height, amplitude, x, width_x)
the gaussian parameters of a 1D distribution by calculating its
moments.  Depending on the input parameters, will only output 
a subset of the above.

If using masked arrays, pass estimator=numpy.ma.median
'estimator' is used to measure the background level (height)

negamp can be used to force the peak negative (True), positive (False),
or it will be "autodetected" (negamp=None)
\end{DoxyVerb}
 \hypertarget{namespacegaussfitter_a5ecea45513967b2a9673f8d484b1659c}{\index{gaussfitter@{gaussfitter}!twodgaussian@{twodgaussian}}
\index{twodgaussian@{twodgaussian}!gaussfitter@{gaussfitter}}
\subsubsection[{twodgaussian}]{\setlength{\rightskip}{0pt plus 5cm}def gaussfitter.\-twodgaussian (
\begin{DoxyParamCaption}
\item[{}]{inpars, }
\item[{}]{circle = {\ttfamily False}, }
\item[{}]{rotate = {\ttfamily True}, }
\item[{}]{vheight = {\ttfamily True}, }
\item[{}]{shape = {\ttfamily None}}
\end{DoxyParamCaption}
)}}\label{namespacegaussfitter_a5ecea45513967b2a9673f8d484b1659c}
\begin{DoxyVerb}Returns a 2d gaussian function of the form:
    x' = numpy.cos(rota) * x - numpy.sin(rota) * y
    y' = numpy.sin(rota) * x + numpy.cos(rota) * y
    (rota should be in degrees)
    g = b + a * numpy.exp ( - ( ((x-center_x)/width_x)**2 +
    ((y-center_y)/width_y)**2 ) / 2 )

    inpars = [b,a,center_x,center_y,width_x,width_y,rota]
             (b is background height, a is peak amplitude)

    where x and y are the input parameters of the returned function,
    and all other parameters are specified by this function

    However, the above values are passed by list.  The list should be:
    inpars = (height,amplitude,center_x,center_y,width_x,width_y,rota)

    You can choose to ignore / neglect some of the above input parameters 
        unumpy.sing the following options:
        circle=0 - default is an elliptical gaussian (different x, y
            widths), but can reduce the input by one parameter if it's a
            circular gaussian
        rotate=1 - default allows rotation of the gaussian ellipse.  Can
            remove last parameter by setting rotate=0
        vheight=1 - default allows a variable height-above-zero, i.e. an
            additive constant for the Gaussian function.  Can remove first
            parameter by setting this to 0
        shape=None - if shape is set (to a 2-parameter list) then returns
            an image with the gaussian defined by inpars\end{DoxyVerb}
 